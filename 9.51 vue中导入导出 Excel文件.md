# vue中导入导出 Excel文件

## 使用

- install

```
npm install -S file-saver xlsx（这里其实安装了2个依赖）

npm install -D script-loader
 
```
- src 下新建一个目录 vender ,将 Export2Excel.js 和 Blob.js 放进来,在build/webpack.base.conf.js里的这个位置

  `'vendor': path.resolve(__dirname, '../src/vendor')`

  - Blob.js: https://github.com/eligrey/Blob.js
  - Export2Excel.js: 

-百度网盘： https://pan.baidu.com/s/4eUiDNPK 
  - 链接:https://pan.baidu.com/s/1zqIpm8hR40QWSrXdTXvSrg  密码:h8gq

- 导出（下载）

```
<el-button :loading="downloadLoading" style="margin:0 0 20px 20px;" type="primary" icon="document" @click="handleDownload">Excel</el-button>

export default {
  name: 'App',
  data(){
    return {
      downloadLoading: false,
      autoWidth: true,
      bookType: 'xlsx',
      filename: '11111111',
      list: [
        {
          id: 1,
          title: '1111',
          author: '1111',
        },
        {
          id: 2,
          title: '2222',
          author: '2222',
        }
      ]
    }
  },

  methods: {
    handleDownload() {
      this.downloadLoading = true
      require.ensure([], () => {
        const { export_json_to_excel } = require('@/excel/Export2Excel')
        const tHeader = ['id', 'title', 'author']
        const filterVal = ['id', 'title', 'author']
        const list = this.list
        const data = this.formatJson(filterVal, list)
        export_json_to_excel(tHeader, data, '列表标题');
        this.downloadLoading = false
      })
    },
    formatJson(filterVal, jsonData) {
      return jsonData.map(v => filterVal.map(j => v[j]))
    }
  },

注意：目前报错了 [Script Loader] ReferenceError: module is not defined
    at eval (eval at module.exports (addScript.js?3fe7:27),

```

- 导入（上传）

```

```



## 参考
- https://www.cnblogs.com/liguiwang/p/8430672.html
- FileSaver.js: https://github.com/eligrey/FileSaver.js
- js-xlsx: https://github.com/SheetJS/js-xlsx
